<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="Comments and solutions for chapter 2 of V.I. Arnold's Methematical Models of Classical Mechanics">
    <meta name="keywords" content="Mathematics,Physics">
    <meta name="author" content="Adi Ofer">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="toc/toc.css">
    <link rel="stylesheet" href="mmocm.css">
    <style>
        body {
            counter-set: h1counter 3;
        }

        /*
        ** Hack to rotate the label of the y axis in plotly.
        ** Ref: https://community.plotly.com/t/y-axis-name-rotation/513/5
        */
        .infolayer [class^='y'][class$='title'] {
            transform: rotate(0deg);
        }
    </style>
    <title>Chapter 2: Investigation of the equations of motion</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdn.plot.ly/plotly-3.0.1.min.js" charset="utf-8"></script>
<body>
<nav id="toc"></nav>
<main>
<div class="chapter">Chapter 2: Investigation of the equations of motion</div>
<div class="content">
\(
    \def\bfx{{\mathbf{x}}}
    \def\R{{\mathbf{R}}}
    \def\Rto#1{{\R^{#1}}}
    \def\Rtwo{{\Rto{2}}}
    \def\vphi{{\varphi}}
    \def\bfvphi{{\mathbf{\varphi}}}
\)
<numberedheadings>
<h1>Systems with one degree of freedom</h1>
Note that this section does not assume a Galilean structure:
for one,
systems with one degree of freedom operate in 1-dimensional spaces whereas Galilean structures operate on 3-dimensional spaces
(looking just at their \(\bfx\)-component, i.e. without time dimension).
Moreover, no invariance under Galilean transformations is used here.

<h2>Definitions</h2>
<h3>Comments</h3>
The definition of the potential energy \(U(x)\) does not depend on the time \(t\);
it is purely a function of the position \(x\).
The kinetic energy, however, is defined in terms of the velocity \(\dot{x}\) and therefore requires a motion \(\varphi(t)\) to make sense.
Both these observations fit our physical mental model.
<p></p>
Regarding the sign in the definition of the potential energy \(U(x)\):
whether \(U\) is a monotonically increasing function of \(x\) depends on \(f\).
In the cases where \(f\) has negative values in the relevant range,
\(U\) is indeed monotonically increasing with \(x\).
This, in particular, hold for the potential energy of a stone
(since the acceleration is towards the ground),
in accordance to the text.
<p>
To show that adding a constant to the potential energy does not change the equation of motion (1),
consider a potential energy \(U(x) = -\int_{x_0}^{x}f(\xi)d\xi\),
and let \(C\in\R\) be a constant.
Since
$$
\frac{d}{dx}\left(U(x)+C\right) = \frac{d}{dx}U(x)=f(x),
$$
we see that \(U(x)+C\) gives rise to the same equation (1).

<!--
<h3>Behavior under 1-dimensional Galilean transformations</h3>
The above-mentioned 1-dimensional analog of the Galilean group is the group generated by the following transformations:
<ul>
    <li>Uniform motion with velocity \(v\in\R\): \(U_{v}(t,x) = (t,x+v t)\).</li>
    <li>Translation by a vector \((t_0,x_0)\in\Rtwo\): \(T_{(t_0,x_0)}(t,x) = (t+t_0,x+x_0)\).</li>
    <li>Rotation by \(G\in\mathbf{O}_1(\R)\): \(R_G(t,x) = (t,Gx)\).
        Note that the only non-trivial rotation is \(G=-1\).
    </li>
</ul>
Let \(\ddot{x}=f(x)\) be a system with one degree of freedom.
As in Section 1.E.1,
requiring this system to comply with the 1-dimensional analog of the principle of relativity
translates into the following conditions:
<ul>
    <li>\(f\) does not depend on \(t\).</li>
    <li>\(f\) depend only on relative \(x\)- and \(\dot{x}\)-coordinates rather than on absolute \(x\)- and \(\dot{x}\)-coordinates.</li>
    <li>\(f(-x)=-f(x)\).</li>
</ul>
The first two conditions are met trivially by \(f\) by virtue of being a function of the single variable \(x\).
Thus the only real requirement here is for \(f\) to be an odd function.
-->

<h3>The law of conservation of energy</h3>
A few observations:
<ul>
    <li>
        Recall that the potential energy \(U\) is defined independently of the time \(t\)
        whereas the kinetic energy \(T\) assumes an existance of a motion.
        Such a motion \(\varphi(t)\) is the context in which the law of conservation of energy holds:
        \(E\) is constant (as a function of \(t\)) along the motion \(\varphi\),
        but may vary across different motions.
    </li>
    <li>
        The law of conservation of energy says that the change of kinetic energy along a motion depends
        only on the change in the position of the motion, regardless of the change in time.
    </li>
    <li>
        The key to the proof of the law of conservation of energy is the existance of a potential energy function \(U(x)\)
        which statisfies \(d\,U/dx=-f\).
        Such a function always exists when there is one degree of freedom (assuming that \(f\) is integrable),
        but does not necessarliy exist in higher dimensions.
    </li>
    <li>
        As noted above no Galilean structure is assumed,
        thus the law of conservation of energy holds for all systems with one degree of freedom
        regardless of any Galilean structure context.
    </li>
</ul>

<h2>Phase flow</h2>
<h3>Notation</h3>
We denote the \(x\)- and \(y\)-coordinates of a motion \(\bfvphi:\R\rightarrow\Rtwo\) by \(\bfvphi_x,\bfvphi_y\),
respectively.
<h3>Comments</h3>
The phase velocity vector field is determined by the right-hand side of both equations in (2),
i.e. it is the vector field defined by
$$
(x,y)\mapsto(y,f(x)).
$$
<p></p>
Let \(\bfvphi:\R\rightarrow\Rtwo\) be a motion solving equation (2).
Then \(\dot{\bfvphi} = \left(\dot{\bfvphi_x}, \dot{\bfvphi_y}\right) = \left(\bfvphi_y,f(\bfvphi_x)\right)\),
so we see that the velocity of the moving point of \(\bfvphi\) at each moment of time
is indeed equal to the phase velocity vector at the location of the phase point at that moment.
<p></p>
Note, though, that the definition of phase velocity vectors (and, by extension, of the entire phase velocity vector field)
relies just on the coordinates of the phase plane,
and does not depend on any particular motion.

<h3>Problem: the uniqueness of a phase curve through a phase point</h3>
<proof>
Let \(\vphi,\vphi'\) be two motions whose phase curves pass through the same phase point \((x_0,y_0)\):
<p></p>
\begin{align}
\vphi(t_0) & = (x_0,y_0), \\
\vphi'(t'_0) & = (x_0,y_0).
\end{align}
Define another motion \(\psi(t)=\vphi'(t+\Delta t)\) where \(\Delta t = t'_0-t_0\).
Then
$$
\ddot{\psi_x}(t)=\ddot{\vphi'_x}(t+\Delta t)=f\left(\vphi'_x(t+\Delta t)\right)=f(\psi_x(t)),
$$
implying that \(\psi\) is another motion solving (2).
But \(\psi(t_0)=\vphi'(t'_0)=(x_0,y_0)\),
so by uniqueness of the solution of an ordinary differential equation with given initial conditions we see that \(\psi = \vphi\).
But \(\psi\) and \(\vphi'\) have the same phase curve, so this completes the proof.
</proof>

<h3>Equilibrium positions</h3>
Let \(\bfvphi:\R\rightarrow\Rtwo\) be a motion whose phase curve is an equilibrium position.
By definition this means that \(x=\bfvphi_x\) and \(y=\bfvphi_y\) are constants.
Thus \((y,f(x))=(\dot{x},\dot{y})=(0,0)\) along the image of \(\varphi\) (i.e. at the equilibrium position),
that is phase velocity vector is zero.

<h2>Examples</h2>
<h3>Example 1</h3>
The "radius vector" is the phase point \((x,y)\);
its inner product (denoted \(\left<,\right>\) here) with the phase velocity vector at that same phase point is
\(\left<(x,y),(y,f(x))\right> = xy+yf(x) = xy-yx = 0,\)
which shows that the two vectors are perpendicular.
They both have the same magnitidue, namely \(\sqrt{x^2+y^2}\).

<h3>Example 2</h3>
<h4>Fact 1</h4>
We show that a point \((\xi,y)\) is an equilibrium position iff both of the following conditions hold:
<ul>
    <li>The point is on the \(x\)-axis, and</li>
    <li>\(\xi\) is a critical point of the potential energy \(U\).</li>
</ul>
First, let \(P=(\xi,y)\) be an equilibrium position.
Then, as seen above, the phase velocity vector at \(P\) is zero.
Thus
<ul>
    <li>
        \(y\), which is the first coordinate of the phase velocity vector, is zero at \(P\),
        showing that \(P\) lies on the \(x\)-axis of the phase plane.
    </li>
    <li>
        Looking at the second coordinate of the phase velocity vector we get \(\left.-d\,U/dx\right|_{x=\xi}=-f(\xi)=0\).
    </li>
</ul>
Conversely let \(\xi\) be a critical point of the potential energy \(U\),
and consider the point \((\xi,0)\) of the phase plane.
Let \(\bfvphi:\R\rightarrow\Rtwo\) be the constant motion \(\varphi(t)=(\xi,0)\).
Then \(\dot{\varphi_x} = 0 = \varphi_y\)
and \(\dot{\varphi_y} = 0 = \left.-d\,U/dx\right|_{x=\xi} = f(\varphi_x)\),
so \(\varphi\) is a solution of equation (2).
This shows that \((\xi,0)\) is an equilibrium position.

<h4>Fact 2</h4>
Let \(p=(\xi,\chi)\) be a point on the level set \(L_0\) of energy \(E_0\).
This level set is the set of solutions, in the phase plane, of the equation \(L(x,y)=0\) where \(L(x,y)=E(x,y)-E_0\).
From the definition of the energy function we get that the gradient of \(L\) is
$$
\nabla L =
\left(\frac{\partial L}{\partial x}, \frac{\partial L}{\partial y}\right) =
\left(\frac{dU}{dx}, y\right).
$$
If \(p\) is not an equilibrium position then the gradient of \(L\) at \(p\) has rank 1 (i.e. it is not the zero vector),
so by the implicit function theorem there exists a unique differentiable function \(\varphi\), such that either
<ul>
    <li>
        \(\chi = \varphi(\xi)\) and \(L(x,\varphi(x))=0\) in a neighborhood of \(\xi\), or
    </li>
    <li>
        \(\xi = \varphi(\chi)\) and \(L(\varphi(y),y)=0\) in a neighborhood of \(\chi\).
    </li>
</ul>
Either way this shows that the level set \(L_0\) is a smooth curve in some neighborhood of \(p\).
<p></p>
For the second part of the fact assume that \(E_0\) is not a critical value of the potential energy.
Then, by the previous fact, no point \(p\in L_0\) is an equilibrium position,
and so \(L_0\) is a smooth curve&mdash;the graph of a unique differentiable function \(\varphi_{p}\)&mdash;in some neighborhood of \(p\).
The uniqueness part implies that the various \(\varphi_{p}\), \(p\in L_0\),
are equal whenever their domains of definition overlap,
hence they can be combined to form a "global" differential function \(\varphi\) whose graph is \(L_0\).
This shows that \(L_0\) in its entirety ("globally") is a smooth curve.

<h3>Problem: the time it takes to get from \(x_1\) to \(x_2\)</h3>
<proof>
    Let \(\varphi\) be a motion such that \(\varphi(t_1)=x_1\) and \(\varphi(t_2)=x_2\).
We look at the phase plane coordinates \((x,y)\).
Changing variables \(x=\varphi(t)\) in the integral we get
$$
\int_{x_1}^{x_2}\frac{dx}{\sqrt{2(E-U(x))}}=
\int_{x_1}^{x_2}\frac{dx}{\sqrt{y^2}}=
\int_{t_1}^{t_2}\frac{\dot{x}(t)}{\sqrt{\dot{x}^2(t)}}dt.
$$
The assumption that we go from \(x_1\) to \(x_2\) in one direction means that we can assume that
\(\dot{\varphi}(t)\) is either positive or negative throughout the journey.
Without loss of generality we can assume that the sign is positive,
otherwise we can swap the order of \(x_1\) and \(x_2\)&mdash;we care about the absolute value of the time, anyway.
Thus the numerator and denominator in the integral cancel out, and we get the desired result.
</proof>

<h3>Problem: phase curves for the equation of an ideal planar pendulum</h3>
As noted in the remark following the problem statement in the book
\(x\) denotes the angle of displacement of the pendulum
and, accordingly, \(\dot{x}\) is the rate of change of this angle.
<p>
The potential energy function is
$$
U(x) = -\int_{x_0}^{x}-\sin(\xi)d\xi = \cos x_0 - \cos x.
$$
We take \(x_0=0\) so that \(U(x)=1-\cos x\).
The critical points of \(U\) are \(\pi\cdot n\) for \(n\in\mathbf{Z}\),
the critical values of the potential energy are \(0\) and \(2\),
and it follows from the two facts above that the equilibrium positions are the points \((\pi\cdot n,0)\), \(n\in\mathbf{Z}\) in the phase plane.
<p>
The \(L_0\) level set is given by
$$
L_0 = \frac{1}{2}y^2 + 1 - \cos x = \frac{1}{2}y^2 + 2\sin^2(x/2)
$$
so
$$
y = \pm\sqrt{2L_0 - 4\sin^{2}(x/2)}.
$$
Note that \(\sin^2\) is periodic with period \(\pi\),
so the expression for \(y\) above is periodic with period \(2\pi\).
Plugging in the values \(0\), \(\pm\pi/3\), and \(\pm\pi/2\) for \(x\)
we get the points \((0,\pm\sqrt{2L_0})\), \((\pm\pi/3,\pm\sqrt{2L_0-1})\), and \((\pm\pi/2,\pm\sqrt{2L_0-2})\) on the \(L_0\) level set.
<p>
Here is what the phase curves look like:
<div id="graph-ideal-planar-pendulum" style="width: 100%;"></div>

<h3>Problem: phase curves for the equation of a pendulum on a rotating axis</h3>
We use the same notation as in the previous problem.
Here the potential energy is given by
$$
U(x) = -\int_{x_0}^{x}\left(-\sin\xi+M\right)d\xi = \cos x_0 - \cos x + M(x-x_0).
$$
We take \(x_0=0\) so that \(U(x)=1-\cos x + Mx\).
The equilibrium positions are points \((\xi,0)\) where \(\xi\) is a solution of \(\cos x - 1 = Mx\).
This equation has no non-zero solutions if \(\left|M\right|>M_0\) where \(M_0\approx 0.7245\).
The level set \(L_0\) is given by the equation
$$
L_0 = \frac{1}{2}y^2 + 1 - \cos x + Mx = \frac{1}{2}y^2 + 2\sin^2(x/2) + Mx,
$$
and
$$
y = \pm\sqrt{2L_0 + 2\cos x - 2 - 2Mx} = \pm\sqrt{2L_0 - 4\sin^{2}(x/2) - 2Mx}.
$$
We illustrate the phase flows for a few concrete values of \(M\).
Here's the graph for \(M=-0.5\):
<div id="graph-pendulum-rotating-axis-05" style="width: 100%;"></div>
For \(M=0.35\):
<div id="graph-pendulum-rotating-axis035" style="width: 100%;"></div>
For \(M=0.7\):
<div id="graph-pendulum-rotating-axis07" style="width: 100%;"></div>
For \(M=1\):
<div id="graph-pendulum-rotating-axis1" style="width: 100%;"></div>
And finally, for \(M=1.5\):
<div id="graph-pendulum-rotating-axis15" style="width: 100%;"></div>

<h3>Problem: tangent lines to branches of critical level at maximal potential energy</h3>
Recall that in the phase plane \(y=\dot{x}\).
From the definition of the potential energy \(U\) we get:
$$
U' = -\ddot{x} = -\frac{dy}{dt} = -\frac{dy}{dx}\frac{dx}{dt} = -y'y
$$
(here the \(F'\) denotes the derivative of a function \(F\) with respect to \(x\)).
Thus \(U'' = -y''y-(y')^2\).
<p>
At phase plane point \((\xi,\chi)\) where the energy is equal to the maximal potential energy
the \(y\)-coordinate, which is the velocity, must be zero: \(\chi=0\).
It follows, then, that at such a point \(U''(\xi) = -\left(y'(\xi)\right)^2\),
hence the equation of the tangent lines (at this point) is
$$
y = y - \chi = y'(\xi)(x-\xi) = \pm\sqrt{-U''(\xi)}\cdot(x-\xi).
$$

<h3>Problem: the period of motion along a closed phase curve</h3>
<proof>
Consider a close phase curve (with is not an equilibrium position) corresponding to energy level \(E\),
and let \(S(E)\) denote the area enclosed by this curve.
Along the curve \(y^2=E-U(x)\),
hence the curve is symmetric along the \(x\)-axis and \(S(E)\) is twice the area bound
by the \(x\)-axis from below and by the phase curve from above.
Without loss of generality we can assume that our phase curve intersects the \(x\)-axis only at two points,
\(x_1\) and \(x_2\),
with \(x_1\lt x_2\).
Then
$$
S(E) = 2\int_{x_1}^{x_2}y\cdot dx = 2\int_{x_1}^{x_2}\sqrt{2(E-U(x))}\cdot dx.
$$
Applying Leibniz Integral Rule we get
$$
\frac{dS}{dE} = 2\int_{x_1}^{x_2}\frac{\partial}{\partial E}\left(\sqrt{2(E-U(x))}\right) dx =
2\int_{x_1}^{x_2}\frac{2}{2\sqrt{2(E-U(x))}}dx.
$$
Per an earlier problem the integral on the right hand side is equal to \(t_2-t_1\),
where \(t_1,t_2\) are the times in which the motion goes through \(x_1,x_2\), respectively,
which in turn is half the period \(T\).
Thus \(T=dS/dE\).
</proof>

<h2>Phase flow</h2>
<h3>Example 1: phase flow of the basic equation of the theory of oscillations</h3>
This is a reformulation of Section C, Example 1:
$$
g^{t}\begin{pmatrix}r_0\cdot\cos\varphi_0 \\ r_0\cdot\sin\varphi_0 \\ \end{pmatrix}
=
\begin{pmatrix}r_0\cdot\cos(\varphi_0 - t) \\ r_0\cdot\sin(\varphi_0 - t) \\ \end{pmatrix}.
$$
<h1>Systems with two degrees of freedom</h1>

</numberedheadings>
</div>
</main>
<script type="module">
    import add_toc from "./toc/toc.js";
    add_toc("main", "toc");

    // Phase curves plot: ideal planar pendulum
    let piCodePoint = 0x0001D70B;
    const tickvals = [];
    const ticktext = [];
    for (let i = -4; i <= 4; i++) {
        if (i == 0) {
            tickvals.push(0);
            ticktext.push("0");
        } else {
            tickvals.push(i * Math.PI);
            ticktext.push(`${i}` + String.fromCodePoint(piCodePoint));
        }
    }
    const layout = {
        //margin: { l: 50, r: 50, t: 50, b: 50, pad: 40, },
        margin: { l: 100, r: 100, t: 40, b: 40, },
        showlegend: false,
        xaxis: {
            tickmode: "array",
            tickvals: tickvals,
            ticktext: ticktext,
            title: { text: "x" },
        },
        yaxis: {
            title: { text: String.fromCodePoint(0x00001E8B) },
        },
    };

    // Range and resolution settings
    const xRange = [-4 * Math.PI, 4 * Math.PI];
    const yRange = [-3, 3];
    const xResolution = 100; // Number of points in x dimension
    const yResolution = 100; // Number of points in y dimension

    // Create arrays of x and y values
    const x = Array.from({length: xResolution}, (_, i) => xRange[0] + i * (xRange[1] - xRange[0]) / (xResolution - 1));
    const y = Array.from({length: yResolution}, (_, i) => yRange[0] + i * (yRange[1] - yRange[0]) / (yResolution - 1));

    // Calculate function values for the level set
    function calculate_level_set_data(M) {
        const z = [];
        for (let i = 0; i < yResolution; i++) {
            const zRow = [];
            for (let j = 0; j < xResolution; j++) {
                zRow.push(y[i] * y[i] / 2 + 1 - Math.cos(x[j]) + M * x[j]);  // level value
            }
            z.push(zRow);
        }
        return z;
    }

    // Equilibrium positions
    const xEq = Array.from({length: 9}, (_, i) => (i - 4) * Math.PI);
    const yEq = Array.from({length: 9}, (_, i) => 0);

    // Prepare the plot data
    function prepare_plot_data(M) {
        return {
            x: x,
            y: y,
            z: calculate_level_set_data(M),
            type: 'contour',
            showscale: false,      // no color scale bar
            contours: {
                coloring: 'none',  // no fill color between contour lines
                showlabels: true,  // show value labels on contour lines
                start: 0,
                end: 6,
                size: 0.5,
            },
            line: {                // contour line settings
                width: 1,
                color: "black", //"rgb(4, 7, 32)", //"rgb(188, 198, 204)", //"darkgray", //"StormyGray",
            },
        };
    }

    const data = [
        prepare_plot_data(0),
        {
            x: xEq,
            y: yEq,
            mode: 'markers',       // Display as points
            type: 'scatter',
            marker: {
                size: 4,
                color: 'black',
                symbol: 'circle',    // You can change to: square, diamond, cross, x, triangle, etc.
            },
        },
    ];

    // Plot the phase flows
    Plotly.newPlot("graph-ideal-planar-pendulum", data, layout);
    Plotly.newPlot("graph-pendulum-rotating-axis-05", [prepare_plot_data(-0.5)], layout);
    Plotly.newPlot("graph-pendulum-rotating-axis035", [prepare_plot_data(0.35)], layout);
    Plotly.newPlot("graph-pendulum-rotating-axis07", [prepare_plot_data(0.7)], layout);
    Plotly.newPlot("graph-pendulum-rotating-axis1", [prepare_plot_data(1)], layout);
    Plotly.newPlot("graph-pendulum-rotating-axis15", [prepare_plot_data(1.5)], layout);
</script>
</body>
</html>
